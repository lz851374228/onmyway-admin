var R=(b,r,i)=>new Promise((u,v)=>{var o=n=>{try{m(i.next(n))}catch(f){v(f)}},k=n=>{try{m(i.throw(n))}catch(f){v(f)}},m=n=>n.done?u(n.value):Promise.resolve(n.value).then(o,k);m((i=i.apply(b,r)).next())});import{d as A,k as S,r as N,e as O,u as e,_ as P,$ as U,t as $,A as L,f as s,aa as t,E as d,a1 as c,an as h,F as q}from"./vue-625a50e2.js";import{u as K,a as V,b as G,L as p,_ as Q}from"./LoginFormTitle.vue_vue_type_script_setup_true_lang-ae57f706.js";import{b as W,f as j,a4 as H,a6 as J}from"./index.js";import{ap as T,$ as D,aq as X,_ as y,ar as Y,as as Z}from"./antd-d44a863f.js";const ne=A({__name:"LoginForm",setup(b){const r=Y,i=Z,u=T.Item,v=D.Password,{t:o}=W(),{notification:k,createErrorModal:m}=J(),{prefixCls:n}=j("login"),f=H(),{setLoginState:x,getLoginState:B}=K(),{getFormRules:M}=V(),C=S(),w=S(!1),E=S(!1),g=N({account:"vben",password:"123456"}),{validForm:z}=G(C),F=O(()=>e(B)===p.LOGIN);function I(){return R(this,null,function*(){const _=yield z();if(_)try{w.value=!0;const a=yield f.login({password:_.password,username:_.account,mode:"none"});a&&k.success({message:o("sys.login.loginSuccessTitle"),description:`${o("sys.login.loginSuccessDesc")}: ${a.nickname}`,duration:3})}catch(a){m({title:o("sys.api.errorTip"),content:a.message||o("sys.api.networkExceptionMsg"),getContainer:()=>document.body.querySelector(`.${n}`)||document.body})}finally{w.value=!1}})}return(_,a)=>(P(),U(q,null,[$(s(Q,{class:"enter-x"},null,512),[[L,F.value]]),$(s(e(T),{class:"p-4 enter-x",model:g,rules:e(M),ref_key:"formRef",ref:C,onKeypress:h(I,["enter"])},{default:t(()=>[s(e(u),{name:"account",class:"enter-x"},{default:t(()=>[s(e(D),{size:"large",value:g.account,"onUpdate:value":a[0]||(a[0]=l=>g.account=l),placeholder:e(o)("sys.login.userName"),class:"fix-auto-fill"},null,8,["value","placeholder"])]),_:1}),s(e(u),{name:"password",class:"enter-x"},{default:t(()=>[s(e(v),{size:"large",visibilityToggle:"",value:g.password,"onUpdate:value":a[1]||(a[1]=l=>g.password=l),placeholder:e(o)("sys.login.password")},null,8,["value","placeholder"])]),_:1}),s(e(i),{class:"enter-x"},{default:t(()=>[s(e(r),{span:12},{default:t(()=>[s(e(u),null,{default:t(()=>[s(e(X),{checked:E.value,"onUpdate:checked":a[2]||(a[2]=l=>E.value=l),size:"small"},{default:t(()=>[d(c(e(o)("sys.login.rememberMe")),1)]),_:1},8,["checked"])]),_:1})]),_:1}),s(e(r),{span:12},{default:t(()=>[s(e(u),{style:{"text-align":"right"}},{default:t(()=>[s(e(y),{type:"link",size:"small",onClick:a[3]||(a[3]=l=>e(x)(e(p).RESET_PASSWORD))},{default:t(()=>[d(c(e(o)("sys.login.forgetPassword")),1)]),_:1})]),_:1})]),_:1})]),_:1}),s(e(u),{class:"enter-x"},{default:t(()=>[s(e(y),{type:"primary",size:"large",block:"",onClick:I,loading:w.value},{default:t(()=>[d(c(e(o)("sys.login.loginButton")),1)]),_:1},8,["loading"])]),_:1}),s(e(i),{class:"enter-x"},{default:t(()=>[s(e(r),{md:8,xs:24},{default:t(()=>[s(e(y),{block:"",onClick:a[4]||(a[4]=l=>e(x)(e(p).MOBILE))},{default:t(()=>[d(c(e(o)("sys.login.mobileSignInFormTitle")),1)]),_:1})]),_:1}),s(e(r),{md:8,xs:24,class:"!my-2 !md:my-0 xs:mx-0 md:mx-2"},{default:t(()=>[s(e(y),{block:"",onClick:a[5]||(a[5]=l=>e(x)(e(p).QR_CODE))},{default:t(()=>[d(c(e(o)("sys.login.qrSignInFormTitle")),1)]),_:1})]),_:1}),s(e(r),{md:6,xs:24},{default:t(()=>[s(e(y),{block:"",onClick:a[6]||(a[6]=l=>e(x)(e(p).REGISTER))},{default:t(()=>[d(c(e(o)("sys.login.registerButton")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules","onKeypress"]),[[L,F.value]])],64))}});export{ne as _};
